<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="ABC ë†€ì´" />
  <link rel="manifest" href="data:application/json,%7B%22name%22%3A%22ABC%20%EC%95%8C%ED%8C%8C%EB%B2%B3%20%EB%86%80%EC%9D%B4%22%2C%22short_name%22%3A%22ABC%20%EB%86%80%EC%9D%B4%22%2C%22start_url%22%3A%22.%22%2C%22display%22%3A%22standalone%22%2C%22background_color%22%3A%22%23FFF5F5%22%2C%22theme_color%22%3A%22%234DABF7%22%7D" />
  <title>ğŸŒˆ ABC ì•ŒíŒŒë²³ ë†€ì´</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
    html, body { overflow: hidden; height: 100%; position: fixed; width: 100%; overscroll-behavior: none; touch-action: none; }
    #root { height: 100%; overflow-y: auto; overflow-x: hidden; -webkit-overflow-scrolling: touch; overscroll-behavior: none; }
    @keyframes confettiFall { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
    @keyframes popIn { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
    @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-8px); } }
    @keyframes shake { 0%, 100% { transform: translateX(0); } 20% { transform: translateX(-12px); } 40% { transform: translateX(12px); } 60% { transform: translateX(-8px); } 80% { transform: translateX(8px); } }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useRef, useEffect, useCallback } = React;

    const ALPHABET_DATA = [
      { letter: "A", word: "Apple", emoji: "ğŸ" },
      { letter: "B", word: "Bear", emoji: "ğŸ»" },
      { letter: "C", word: "Cat", emoji: "ğŸ±" },
      { letter: "D", word: "Dog", emoji: "ğŸ¶" },
      { letter: "E", word: "Elephant", emoji: "ğŸ˜" },
      { letter: "F", word: "Fish", emoji: "ğŸŸ" },
      { letter: "G", word: "Grape", emoji: "ğŸ‡" },
      { letter: "H", word: "House", emoji: "ğŸ " },
      { letter: "I", word: "Ice cream", emoji: "ğŸ¦" },
      { letter: "J", word: "Jellyfish", emoji: "ğŸª¼" },
      { letter: "K", word: "Kite", emoji: "ğŸª" },
      { letter: "L", word: "Lion", emoji: "ğŸ¦" },
      { letter: "M", word: "Moon", emoji: "ğŸŒ™" },
      { letter: "N", word: "Nest", emoji: "ğŸªº" },
      { letter: "O", word: "Orange", emoji: "ğŸŠ" },
      { letter: "P", word: "Penguin", emoji: "ğŸ§" },
      { letter: "Q", word: "Queen", emoji: "ğŸ‘‘" },
      { letter: "R", word: "Rainbow", emoji: "ğŸŒˆ" },
      { letter: "S", word: "Star", emoji: "â­" },
      { letter: "T", word: "Tree", emoji: "ğŸŒ³" },
      { letter: "U", word: "Umbrella", emoji: "â˜‚ï¸" },
      { letter: "V", word: "Violin", emoji: "ğŸ»" },
      { letter: "W", word: "Whale", emoji: "ğŸ‹" },
      { letter: "X", word: "Xylophone", emoji: "ğŸµ" },
      { letter: "Y", word: "Yacht", emoji: "â›µ" },
      { letter: "Z", word: "Zebra", emoji: "ğŸ¦“" },
    ];

    const PASTEL_COLORS = [
      "#FF6B6B", "#FF8E72", "#FFA94D", "#FFD43B", "#A9E34B",
      "#69DB7C", "#38D9A9", "#3BC9DB", "#4DABF7", "#748FFC",
      "#9775FA", "#DA77F2", "#F06595", "#FF8787", "#FFA8A8",
      "#FFD8A8", "#FFEC99", "#D8F5A2", "#96F2D7", "#99E9F2",
      "#A5D8FF", "#BAC8FF", "#D0BFFF", "#EEBEFA", "#FCC2D7",
      "#E599F7",
    ];

    const speak = (text, rate = 0.8) => {
      window.speechSynthesis.cancel();
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = "en-US";
      utterance.rate = rate;
      utterance.pitch = 1.1;
      window.speechSynthesis.speak(utterance);
    };

    const playCorrectSound = () => {
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const playTone = (freq, startTime, duration) => {
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type = "sine";
          osc.frequency.value = freq;
          gain.gain.setValueAtTime(0.3, startTime);
          gain.gain.exponentialRampToValueAtTime(0.01, startTime + duration);
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.start(startTime);
          osc.stop(startTime + duration);
        };
        playTone(830, ctx.currentTime, 0.15);
        playTone(1100, ctx.currentTime + 0.15, 0.25);
      } catch (e) {}
    };

    const playWrongSound = () => {
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.type = "square";
        osc.frequency.value = 200;
        gain.gain.setValueAtTime(0.15, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.25);
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.25);
      } catch (e) {}
    };

    const Confetti = ({ show }) => {
      if (!show) return null;
      const pieces = Array.from({ length: 40 }, (_, i) => ({
        id: i, left: Math.random() * 100, delay: Math.random() * 0.5,
        color: ["#FF6B6B", "#FFD43B", "#69DB7C", "#4DABF7", "#DA77F2", "#FF8E72"][i % 6],
        size: 6 + Math.random() * 8,
      }));
      return (
        <div style={{ position: "fixed", inset: 0, pointerEvents: "none", zIndex: 9999 }}>
          {pieces.map((p) => (
            <div key={p.id} style={{
              position: "absolute", left: p.left + "%", top: "-10px",
              width: p.size, height: p.size, backgroundColor: p.color,
              borderRadius: Math.random() > 0.5 ? "50%" : "2px",
              animation: "confettiFall 1.8s " + p.delay + "s ease-in forwards",
            }} />
          ))}
        </div>
      );
    };

    const TabNav = ({ activeTab, setActiveTab }) => {
      const tabs = [
        { id: "cards", label: "ì¹´ë“œ", icon: "ğŸƒ" },
        { id: "write", label: "ë”°ë¼ì“°ê¸°", icon: "âœï¸" },
        { id: "match", label: "ë§¤ì¹­", icon: "ğŸ¯" },
        { id: "typing", label: "íƒ€ì´í•‘", icon: "âŒ¨ï¸" },
      ];
      return (
        <div style={{
          display: "flex", gap: 6, justifyContent: "center", padding: "10px 12px",
          background: "rgba(255,255,255,0.7)", borderRadius: 20, margin: "0 auto",
          backdropFilter: "blur(10px)", maxWidth: 500,
        }}>
          {tabs.map((tab) => (
            <button key={tab.id} onClick={() => setActiveTab(tab.id)} style={{
              flex: 1, padding: "10px 4px", border: "none", borderRadius: 14, cursor: "pointer",
              fontSize: 14, fontWeight: 700, fontFamily: "'Nunito', sans-serif",
              transition: "all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)",
              background: activeTab === tab.id ? "#4DABF7" : "transparent",
              color: activeTab === tab.id ? "#fff" : "#555",
              transform: activeTab === tab.id ? "scale(1.05)" : "scale(1)",
              boxShadow: activeTab === tab.id ? "0 4px 15px rgba(77,171,247,0.4)" : "none",
            }}>
              <span style={{ fontSize: 18 }}>{tab.icon}</span><br />
              <span style={{ fontSize: 11 }}>{tab.label}</span>
            </button>
          ))}
        </div>
      );
    };

    const AlphabetCards = () => {
      const [currentIndex, setCurrentIndex] = useState(0);
      const [showLower, setShowLower] = useState(false);
      const [flipAnim, setFlipAnim] = useState(false);
      const data = ALPHABET_DATA[currentIndex];
      const color = PASTEL_COLORS[currentIndex];

      const handlePrev = () => { setFlipAnim(true); setTimeout(() => { setCurrentIndex((i) => (i - 1 + 26) % 26); setShowLower(false); setFlipAnim(false); }, 250); };
      const handleNext = () => { setFlipAnim(true); setTimeout(() => { setCurrentIndex((i) => (i + 1) % 26); setShowLower(false); setFlipAnim(false); }, 250); };
      const handleSpeak = () => { speak(data.letter.toLowerCase()); };

      return (
        <div style={{ display: "flex", flexDirection: "column", alignItems: "center", gap: 20 }}>
          <div style={{ display: "flex", flexWrap: "wrap", gap: 5, justifyContent: "center", maxWidth: 500, padding: "0 10px" }}>
            {ALPHABET_DATA.map((d, i) => (
              <button key={d.letter} onClick={() => { setCurrentIndex(i); setShowLower(false); }} style={{
                width: 32, height: 32, border: "none", borderRadius: 8, cursor: "pointer",
                fontSize: 13, fontWeight: 800, fontFamily: "'Nunito', sans-serif",
                background: i === currentIndex ? PASTEL_COLORS[i] : "rgba(255,255,255,0.6)",
                color: i === currentIndex ? "#fff" : "#777", transition: "all 0.2s",
                transform: i === currentIndex ? "scale(1.15)" : "scale(1)",
              }}>{d.letter}</button>
            ))}
          </div>
          <div onClick={handleSpeak} style={{
            width: 280, minHeight: 360, borderRadius: 28, padding: 30, cursor: "pointer",
            background: "linear-gradient(145deg, " + color + "22, " + color + "44)",
            border: "3px solid " + color + "66",
            display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center",
            gap: 10, transition: "all 0.3s", position: "relative",
            transform: flipAnim ? "scale(0.9) rotateY(90deg)" : "scale(1) rotateY(0deg)",
            boxShadow: "0 8px 30px " + color + "33",
          }}>
            <div style={{ fontSize: 80, lineHeight: 1 }}>{data.emoji}</div>
            <div style={{ fontSize: 90, fontWeight: 900, fontFamily: "'Fredoka', 'Nunito', sans-serif", color: color, textShadow: "2px 2px 0px " + color + "44", lineHeight: 1 }}>
              {showLower ? data.letter.toLowerCase() : data.letter}
            </div>
            <div style={{ fontSize: 24, fontWeight: 700, color: "#555", fontFamily: "'Nunito', sans-serif" }}>{data.word}</div>
            <div style={{ display: "flex", gap: 8, marginTop: 5 }}>
              <button onClick={(e) => { e.stopPropagation(); setShowLower(false); }} style={{
                padding: "6px 16px", border: "none", borderRadius: 10, cursor: "pointer",
                fontSize: 16, fontWeight: 800, fontFamily: "'Fredoka', sans-serif",
                background: !showLower ? color : "rgba(0,0,0,0.06)", color: !showLower ? "#fff" : "#999", transition: "all 0.2s",
              }}>{data.letter}</button>
              <button onClick={(e) => { e.stopPropagation(); setShowLower(true); }} style={{
                padding: "6px 16px", border: "none", borderRadius: 10, cursor: "pointer",
                fontSize: 16, fontWeight: 800, fontFamily: "'Fredoka', sans-serif",
                background: showLower ? color : "rgba(0,0,0,0.06)", color: showLower ? "#fff" : "#999", transition: "all 0.2s",
              }}>{data.letter.toLowerCase()}</button>
            </div>
            <div style={{ position: "absolute", top: 12, right: 16, fontSize: 22, opacity: 0.5 }}>ğŸ”Š</div>
          </div>
          <div style={{ display: "flex", gap: 16, alignItems: "center" }}>
            <button onClick={handlePrev} style={{ width: 48, height: 48, border: "none", borderRadius: 14, cursor: "pointer", fontSize: 18, fontWeight: 700, background: "rgba(255,255,255,0.8)", color: "#555", boxShadow: "0 2px 8px rgba(0,0,0,0.08)" }}>â—€</button>
            <span style={{ fontSize: 14, color: "#999", fontFamily: "'Nunito', sans-serif", fontWeight: 700 }}>{currentIndex + 1} / 26</span>
            <button onClick={handleNext} style={{ width: 48, height: 48, border: "none", borderRadius: 14, cursor: "pointer", fontSize: 18, fontWeight: 700, background: "rgba(255,255,255,0.8)", color: "#555", boxShadow: "0 2px 8px rgba(0,0,0,0.08)" }}>â–¶</button>
          </div>
        </div>
      );
    };

    const WritingPractice = () => {
      const canvasRef = useRef(null);
      const [currentIndex, setCurrentIndex] = useState(0);
      const [isDrawing, setIsDrawing] = useState(false);
      const [isLower, setIsLower] = useState(false);
      const data = ALPHABET_DATA[currentIndex];
      const color = PASTEL_COLORS[currentIndex];

      const clearCanvas = useCallback(() => {
        const canvas = canvasRef.current;
        if (!canvas) return;
        const ctx = canvas.getContext("2d");
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = "bold 180px Fredoka, Nunito, sans-serif";
        ctx.textAlign = "center"; ctx.textBaseline = "middle";
        ctx.fillStyle = color + "40";
        ctx.fillText(isLower ? data.letter.toLowerCase() : data.letter, canvas.width / 2, canvas.height / 2);
        ctx.strokeStyle = "#ddd"; ctx.lineWidth = 1; ctx.setLineDash([5, 5]);
        ctx.beginPath(); ctx.moveTo(20, canvas.height * 0.65); ctx.lineTo(canvas.width - 20, canvas.height * 0.65); ctx.stroke(); ctx.setLineDash([]);
      }, [currentIndex, isLower, color, data.letter]);

      useEffect(() => { clearCanvas(); }, [clearCanvas]);

      const getPos = (e) => {
        const canvas = canvasRef.current; const rect = canvas.getBoundingClientRect();
        const scaleX = canvas.width / rect.width; const scaleY = canvas.height / rect.height;
        if (e.touches) return { x: (e.touches[0].clientX - rect.left) * scaleX, y: (e.touches[0].clientY - rect.top) * scaleY };
        return { x: (e.clientX - rect.left) * scaleX, y: (e.clientY - rect.top) * scaleY };
      };
      const startDraw = (e) => { e.preventDefault(); setIsDrawing(true); const ctx = canvasRef.current.getContext("2d"); const pos = getPos(e); ctx.beginPath(); ctx.moveTo(pos.x, pos.y); ctx.strokeStyle = color; ctx.lineWidth = 6; ctx.lineCap = "round"; ctx.lineJoin = "round"; };
      const draw = (e) => { e.preventDefault(); if (!isDrawing) return; const ctx = canvasRef.current.getContext("2d"); const pos = getPos(e); ctx.lineTo(pos.x, pos.y); ctx.stroke(); };
      const stopDraw = () => setIsDrawing(false);

      return (
        <div style={{ display: "flex", flexDirection: "column", alignItems: "center", gap: 16 }}>
          <div style={{ display: "flex", gap: 6, flexWrap: "wrap", justifyContent: "center" }}>
            {ALPHABET_DATA.map((d, i) => (
              <button key={d.letter} onClick={() => setCurrentIndex(i)} style={{
                width: 30, height: 30, border: "none", borderRadius: 7, cursor: "pointer",
                fontSize: 12, fontWeight: 800, fontFamily: "'Nunito', sans-serif",
                background: i === currentIndex ? PASTEL_COLORS[i] : "rgba(255,255,255,0.5)",
                color: i === currentIndex ? "#fff" : "#888", transition: "all 0.2s",
              }}>{d.letter}</button>
            ))}
          </div>
          <div style={{ display: "flex", gap: 10, alignItems: "center" }}>
            <span style={{ fontSize: 40 }}>{data.emoji}</span>
            <span style={{ fontSize: 48, fontWeight: 900, color: color, fontFamily: "'Fredoka', sans-serif" }}>{isLower ? data.letter.toLowerCase() : data.letter}</span>
            <button onClick={() => speak(data.letter.toLowerCase())} style={{ background: "none", border: "none", fontSize: 28, cursor: "pointer" }}>ğŸ”Š</button>
          </div>
          <div style={{ display: "flex", gap: 8 }}>
            <button onClick={() => setIsLower(false)} style={{ padding: "6px 18px", border: "none", borderRadius: 10, cursor: "pointer", fontSize: 16, fontWeight: 800, fontFamily: "'Fredoka', sans-serif", background: !isLower ? color : "#eee", color: !isLower ? "#fff" : "#aaa" }}>ëŒ€ë¬¸ì</button>
            <button onClick={() => setIsLower(true)} style={{ padding: "6px 18px", border: "none", borderRadius: 10, cursor: "pointer", fontSize: 16, fontWeight: 800, fontFamily: "'Fredoka', sans-serif", background: isLower ? color : "#eee", color: isLower ? "#fff" : "#aaa" }}>ì†Œë¬¸ì</button>
          </div>
          <div style={{ position: "relative", borderRadius: 20, overflow: "hidden", boxShadow: "0 4px 20px rgba(0,0,0,0.08)", background: "#fff", border: "3px solid " + color + "33" }}>
            <canvas ref={canvasRef} width={300} height={300} style={{ width: 300, height: 300, touchAction: "none", cursor: "crosshair" }}
              onMouseDown={startDraw} onMouseMove={draw} onMouseUp={stopDraw} onMouseLeave={stopDraw}
              onTouchStart={startDraw} onTouchMove={draw} onTouchEnd={stopDraw} />
          </div>
          <div style={{ display: "flex", gap: 10 }}>
            <button onClick={clearCanvas} style={{ padding: "10px 24px", border: "none", borderRadius: 12, cursor: "pointer", fontSize: 14, fontWeight: 700, fontFamily: "'Nunito', sans-serif", background: "#FF6B6B", color: "#fff" }}>ğŸ—‘ï¸ ì§€ìš°ê¸°</button>
            <button onClick={() => { speak("Great job!"); clearCanvas(); setCurrentIndex((i) => (i + 1) % 26); }} style={{ padding: "10px 24px", border: "none", borderRadius: 12, cursor: "pointer", fontSize: 14, fontWeight: 700, fontFamily: "'Nunito', sans-serif", background: "#69DB7C", color: "#fff" }}>âœ… ë‹¤ìŒ ê¸€ì</button>
          </div>
        </div>
      );
    };

    const MatchingGame = () => {
      const [round, setRound] = useState(0);
      const [score, setScore] = useState(0);
      const [total, setTotal] = useState(0);
      const [showConfetti, setShowConfetti] = useState(false);
      const [gameLetters, setGameLetters] = useState([]);
      const [shuffledLowers, setShuffledLowers] = useState([]);
      const [matched, setMatched] = useState([]);
      const [lines, setLines] = useState([]);
      const [dragging, setDragging] = useState(null);
      const [dragLine, setDragLine] = useState(null);
      const [feedback, setFeedback] = useState(null);
      const containerRef = useRef(null);
      const upperRefs = useRef({});
      const lowerRefs = useRef({});

      const generateRound = useCallback(() => {
        const shuffled = [...ALPHABET_DATA].sort(() => Math.random() - 0.5);
        const picks = shuffled.slice(0, 4);
        setGameLetters(picks);
        setShuffledLowers(picks.map((p) => p.letter.toLowerCase()).sort(() => Math.random() - 0.5));
        setMatched([]); setLines([]); setDragging(null); setDragLine(null); setFeedback(null);
      }, []);

      useEffect(() => { generateRound(); }, [round, generateRound]);

      const getCenter = (el) => {
        if (!el || !containerRef.current) return { x: 0, y: 0 };
        const cr = containerRef.current.getBoundingClientRect(); const r = el.getBoundingClientRect();
        return { x: r.left + r.width / 2 - cr.left, y: r.top + r.height / 2 - cr.top };
      };

      const handleUpperStart = (letter, e) => {
        if (matched.includes(letter)) return;
        e.preventDefault(); setDragging(letter);
        const center = getCenter(upperRefs.current[letter]);
        setDragLine({ from: center, to: center }); speak(letter.toLowerCase());
      };

      const handleMove = (e) => {
        if (!dragging || !dragLine) return; e.preventDefault();
        const cr = containerRef.current.getBoundingClientRect();
        const cx = e.touches ? e.touches[0].clientX : e.clientX;
        const cy = e.touches ? e.touches[0].clientY : e.clientY;
        setDragLine((prev) => ({ ...prev, to: { x: cx - cr.left, y: cy - cr.top } }));
      };

      const handleEnd = (e) => {
        if (!dragging) return; e.preventDefault();
        const cx = e.changedTouches ? e.changedTouches[0].clientX : e.clientX;
        const cy = e.changedTouches ? e.changedTouches[0].clientY : e.clientY;
        let foundLower = null;
        for (const lower of shuffledLowers) {
          const el = lowerRefs.current[lower]; if (!el) continue;
          const r = el.getBoundingClientRect();
          if (cx >= r.left && cx <= r.right && cy >= r.top && cy <= r.bottom) { foundLower = lower; break; }
        }
        setTotal((t) => t + 1);
        if (foundLower && foundLower === dragging.toLowerCase() && !matched.includes(dragging)) {
          const fromCenter = getCenter(upperRefs.current[dragging]);
          const toCenter = getCenter(lowerRefs.current[foundLower]);
          const newMatched = [...matched, dragging];
          setMatched(newMatched);
          setLines((prev) => [...prev, { from: fromCenter, to: toCenter }]);
          setScore((s) => s + 1); setFeedback({ type: "correct" }); speak("Correct!");
          if (newMatched.length === gameLetters.length) {
            setShowConfetti(true); speak("Wonderful!");
            setTimeout(() => { setShowConfetti(false); setRound((r) => r + 1); }, 2000);
          }
        } else if (foundLower) { setFeedback({ type: "wrong" }); speak("Oops!"); }
        setDragging(null); setDragLine(null);
        setTimeout(() => setFeedback(null), 1200);
      };

      return (
        <div style={{ display: "flex", flexDirection: "column", alignItems: "center", gap: 20 }}>
          <Confetti show={showConfetti} />
          <div style={{ display: "flex", gap: 12, alignItems: "center", background: "rgba(255,255,255,0.6)", padding: "8px 20px", borderRadius: 14 }}>
            <span style={{ fontSize: 24 }}>â­</span>
            <span style={{ fontSize: 20, fontWeight: 800, color: "#FFD43B", fontFamily: "'Fredoka', sans-serif" }}>{score} / {total}</span>
          </div>
          <div style={{ fontSize: 16, fontWeight: 700, color: "#666", fontFamily: "'Nunito', sans-serif", textAlign: "center" }}>ëŒ€ë¬¸ìì—ì„œ ì†Œë¬¸ìë¡œ<br />ë“œë˜ê·¸í•˜ì—¬ ì—°ê²°í•˜ì„¸ìš”!</div>
          <div ref={containerRef} onMouseMove={handleMove} onMouseUp={handleEnd} onMouseLeave={handleEnd} onTouchMove={handleMove} onTouchEnd={handleEnd}
            style={{ position: "relative", width: "100%", maxWidth: 400, padding: "0 10px", touchAction: "none" }}>
            <svg style={{ position: "absolute", inset: 0, width: "100%", height: "100%", pointerEvents: "none", zIndex: 1 }}>
              {lines.map((line, i) => (<line key={i} x1={line.from.x} y1={line.from.y} x2={line.to.x} y2={line.to.y} stroke="#69DB7C" strokeWidth={3} strokeLinecap="round" strokeDasharray="8 4" />))}
              {dragLine && (<line x1={dragLine.from.x} y1={dragLine.from.y} x2={dragLine.to.x} y2={dragLine.to.y} stroke="#4DABF7" strokeWidth={3} strokeLinecap="round" strokeDasharray="6 4" opacity={0.7} />)}
            </svg>
            <div style={{ display: "flex", gap: 12, justifyContent: "center", marginBottom: 60, position: "relative", zIndex: 2 }}>
              {gameLetters.map((item) => {
                const isMatched = matched.includes(item.letter);
                return (
                  <div key={item.letter} ref={(el) => (upperRefs.current[item.letter] = el)}
                    onMouseDown={(e) => handleUpperStart(item.letter, e)} onTouchStart={(e) => handleUpperStart(item.letter, e)}
                    style={{
                      width: 72, height: 72, borderRadius: 16, cursor: isMatched ? "default" : "grab",
                      display: "flex", alignItems: "center", justifyContent: "center",
                      background: isMatched ? "#69DB7C22" : "rgba(255,255,255,0.85)",
                      border: isMatched ? "3px solid #69DB7C55" : dragging === item.letter ? "3px solid #4DABF7" : "3px solid transparent",
                      transform: dragging === item.letter ? "scale(1.1)" : isMatched ? "scale(0.95)" : "scale(1)",
                      transition: "all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1)",
                      opacity: isMatched ? 0.6 : 1, boxShadow: dragging === item.letter ? "0 4px 15px rgba(77,171,247,0.3)" : "0 2px 8px rgba(0,0,0,0.06)", userSelect: "none",
                    }}>
                    <span style={{ fontSize: 32, fontWeight: 900, color: "#444", fontFamily: "'Fredoka', sans-serif" }}>{item.letter}</span>
                  </div>
                );
              })}
            </div>
            <div style={{ display: "flex", gap: 12, justifyContent: "center", position: "relative", zIndex: 2 }}>
              {shuffledLowers.map((lower, idx) => {
                const isMatched = matched.includes(lower.toUpperCase());
                return (
                  <div key={lower + "-" + idx} ref={(el) => (lowerRefs.current[lower] = el)} style={{
                    width: 72, height: 72, borderRadius: 16, display: "flex", alignItems: "center", justifyContent: "center",
                    background: isMatched ? "#69DB7C22" : "rgba(255,255,255,0.85)",
                    border: isMatched ? "3px solid #69DB7C55" : "3px solid transparent",
                    opacity: isMatched ? 0.6 : 1, transform: isMatched ? "scale(0.95)" : "scale(1)",
                    transition: "all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1)",
                    boxShadow: "0 2px 8px rgba(0,0,0,0.06)", userSelect: "none",
                  }}>
                    <span style={{ fontSize: 32, fontWeight: 900, color: "#444", fontFamily: "'Fredoka', sans-serif" }}>{lower}</span>
                  </div>
                );
              })}
            </div>
          </div>
          {feedback && (
            <div style={{ padding: "10px 24px", borderRadius: 14, background: feedback.type === "correct" ? "#69DB7C22" : "#FF6B6B22", color: feedback.type === "correct" ? "#2B8A3E" : "#C92A2A", fontSize: 16, fontWeight: 700, fontFamily: "'Nunito', sans-serif", animation: "popIn 0.3s ease-out" }}>
              {feedback.type === "correct" ? "ğŸ‰ ì˜í–ˆì–´ìš”!" : "ğŸ˜Š ë‹¤ì‹œ í•´ë´ìš”!"}
            </div>
          )}
          <button onClick={() => setRound((r) => r + 1)} style={{ padding: "10px 24px", border: "none", borderRadius: 12, cursor: "pointer", fontSize: 14, fontWeight: 700, fontFamily: "'Nunito', sans-serif", background: "#4DABF7", color: "#fff" }}>ğŸ”„ ìƒˆ ë¬¸ì œ</button>
        </div>
      );
    };

    const TypingQuiz = () => {
      const [currentIndex, setCurrentIndex] = useState(() => Math.floor(Math.random() * 26));
      const [score, setScore] = useState(0);
      const [total, setTotal] = useState(0);
      const [feedback, setFeedback] = useState(null);
      const [showConfetti, setShowConfetti] = useState(false);
      const [streak, setStreak] = useState(0);
      const [shakeAnim, setShakeAnim] = useState(false);
      const [popAnim, setPopAnim] = useState(false);
      const data = ALPHABET_DATA[currentIndex];
      const color = PASTEL_COLORS[currentIndex];
      const inputRef = useRef(null);

      const nextLetter = useCallback(() => {
        let next; do { next = Math.floor(Math.random() * 26); } while (next === currentIndex);
        setCurrentIndex(next); setFeedback(null); setPopAnim(true);
        setTimeout(() => setPopAnim(false), 300);
      }, [currentIndex]);

      useEffect(() => {
        const handleKey = (e) => {
          if (feedback) return;
          const pressed = e.key.toUpperCase();
          if (!/^[A-Z]$/.test(pressed)) return;
          setTotal((t) => t + 1);
          if (pressed === data.letter) {
            setScore((s) => s + 1); const newStreak = streak + 1; setStreak(newStreak);
            setFeedback("correct"); playCorrectSound(); speak(data.letter.toLowerCase());
            if (newStreak > 0 && newStreak % 5 === 0) { setShowConfetti(true); setTimeout(() => setShowConfetti(false), 2000); }
            setTimeout(() => nextLetter(), 800);
          } else {
            setStreak(0); setFeedback("wrong"); playWrongSound();
            setShakeAnim(true); setTimeout(() => setShakeAnim(false), 500);
            setTimeout(() => setFeedback(null), 1000);
          }
        };
        window.addEventListener("keydown", handleKey);
        return () => window.removeEventListener("keydown", handleKey);
      }, [data.letter, feedback, streak, nextLetter]);

      const handleMobileInput = (e) => {
        const val = e.target.value; if (!val) return;
        const pressed = val.toUpperCase(); e.target.value = "";
        if (!/^[A-Z]$/.test(pressed) || feedback) return;
        setTotal((t) => t + 1);
        if (pressed === data.letter) {
          setScore((s) => s + 1); const newStreak = streak + 1; setStreak(newStreak);
          setFeedback("correct"); playCorrectSound(); speak(data.letter.toLowerCase());
          if (newStreak > 0 && newStreak % 5 === 0) { setShowConfetti(true); setTimeout(() => setShowConfetti(false), 2000); }
          setTimeout(() => nextLetter(), 800);
        } else {
          setStreak(0); setFeedback("wrong"); playWrongSound();
          setShakeAnim(true); setTimeout(() => setShakeAnim(false), 500);
          setTimeout(() => setFeedback(null), 1000);
        }
      };

      return (
        <div style={{ display: "flex", flexDirection: "column", alignItems: "center", gap: 20 }}>
          <Confetti show={showConfetti} />
          <div style={{ display: "flex", gap: 16, alignItems: "center" }}>
            <div style={{ display: "flex", gap: 8, alignItems: "center", background: "rgba(255,255,255,0.6)", padding: "8px 16px", borderRadius: 14 }}>
              <span style={{ fontSize: 22 }}>â­</span>
              <span style={{ fontSize: 18, fontWeight: 800, color: "#FFD43B", fontFamily: "'Fredoka', sans-serif" }}>{score} / {total}</span>
            </div>
            {streak >= 2 && (
              <div style={{ display: "flex", gap: 4, alignItems: "center", background: "#FF6B6B22", padding: "8px 14px", borderRadius: 14, animation: "popIn 0.3s ease-out" }}>
                <span style={{ fontSize: 18 }}>ğŸ”¥</span>
                <span style={{ fontSize: 16, fontWeight: 800, color: "#FF6B6B", fontFamily: "'Fredoka', sans-serif" }}>{streak}ì—°ì†!</span>
              </div>
            )}
          </div>
          <div style={{ fontSize: 16, fontWeight: 700, color: "#666", fontFamily: "'Nunito', sans-serif", textAlign: "center" }}>ì´ ê¸€ìë¥¼ í‚¤ë³´ë“œë¡œ ëˆŒëŸ¬ë³´ì„¸ìš”!</div>
          <div style={{
            width: 200, height: 200, borderRadius: 30,
            display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center",
            background: feedback === "correct" ? "#69DB7C22" : feedback === "wrong" ? "#FF6B6B22" : "linear-gradient(145deg, " + color + "15, " + color + "30)",
            border: feedback === "correct" ? "4px solid #69DB7C" : feedback === "wrong" ? "4px solid #FF6B6B" : "4px solid " + color + "44",
            transition: "all 0.3s",
            animation: shakeAnim ? "shake 0.4s ease-in-out" : popAnim ? "popIn 0.3s ease-out" : "none",
            boxShadow: "0 8px 30px " + color + "22",
          }}>
            <span style={{ fontSize: 40, marginBottom: 4 }}>{data.emoji}</span>
            <span style={{ fontSize: 80, fontWeight: 900, lineHeight: 1, fontFamily: "'Fredoka', sans-serif", color: feedback === "correct" ? "#69DB7C" : feedback === "wrong" ? "#FF6B6B" : color, transition: "color 0.2s" }}>{data.letter}</span>
          </div>
          <div style={{ height: 40, display: "flex", alignItems: "center" }}>
            {feedback === "correct" && <div style={{ fontSize: 20, fontWeight: 800, color: "#2B8A3E", fontFamily: "'Fredoka', sans-serif", animation: "popIn 0.3s ease-out" }}>ğŸ‰ ì •ë‹µ!</div>}
            {feedback === "wrong" && <div style={{ fontSize: 20, fontWeight: 800, color: "#C92A2A", fontFamily: "'Fredoka', sans-serif", animation: "popIn 0.3s ease-out" }}>ğŸ˜Š ë‹¤ì‹œ!</div>}
            {!feedback && <div style={{ fontSize: 28, animation: "float 2s ease-in-out infinite" }}>âŒ¨ï¸</div>}
          </div>
          <input ref={inputRef} type="text" autoComplete="off" autoCapitalize="characters" onInput={handleMobileInput} style={{ position: "absolute", opacity: 0, width: 1, height: 1, pointerEvents: "none" }} />
          <button onClick={() => { inputRef.current && inputRef.current.focus(); }} style={{ padding: "12px 28px", border: "none", borderRadius: 14, cursor: "pointer", fontSize: 15, fontWeight: 700, fontFamily: "'Nunito', sans-serif", background: "#4DABF7", color: "#fff", boxShadow: "0 4px 12px rgba(77,171,247,0.3)" }}>ğŸ“± ëª¨ë°”ì¼ í‚¤ë³´ë“œ ì—´ê¸°</button>
          <button onClick={() => { setScore(0); setTotal(0); setStreak(0); setFeedback(null); nextLetter(); }} style={{ padding: "8px 20px", border: "none", borderRadius: 10, cursor: "pointer", fontSize: 13, fontWeight: 700, fontFamily: "'Nunito', sans-serif", background: "rgba(0,0,0,0.06)", color: "#888" }}>ğŸ”„ ì ìˆ˜ ì´ˆê¸°í™”</button>
        </div>
      );
    };

    function App() {
      const [activeTab, setActiveTab] = useState("cards");
      return (
        <div style={{ minHeight: "100vh", background: "linear-gradient(135deg, #FFF5F5 0%, #FFF9DB 25%, #EBFBEE 50%, #E7F5FF 75%, #F3F0FF 100%)", padding: "20px 16px 40px", fontFamily: "'Nunito', sans-serif" }}>
          <div style={{ textAlign: "center", marginBottom: 20 }}>
            <h1 style={{ fontSize: 28, fontWeight: 900, fontFamily: "'Fredoka', sans-serif", background: "linear-gradient(135deg, #FF6B6B, #FFD43B, #69DB7C, #4DABF7, #9775FA)", WebkitBackgroundClip: "text", WebkitTextFillColor: "transparent", margin: 0, lineHeight: 1.3 }}>ğŸŒˆ ABC ì•ŒíŒŒë²³ ë†€ì´</h1>
            <p style={{ fontSize: 13, color: "#999", margin: "4px 0 0", fontWeight: 600 }}>ì¬ë¯¸ìˆê²Œ ì˜ì–´ë¥¼ ë°°ì›Œìš”!</p>
          </div>
          <TabNav activeTab={activeTab} setActiveTab={setActiveTab} />
          <div style={{ marginTop: 24 }}>
            {activeTab === "cards" && <AlphabetCards />}
            {activeTab === "write" && <WritingPractice />}
            {activeTab === "match" && <MatchingGame />}
            {activeTab === "typing" && <TypingQuiz />}
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
